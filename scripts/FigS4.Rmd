---
title: "Individual subject fits"
output: html_document
---


```{r set-up, warning=FALSE, message=FALSE, results="hide"}
# Clear workspace
rm(list = ls())

# Load helper functions
source('helper_functions.R')

# Import libraries
packages = c("tidyr","dplyr","ggplot2","lme4","lmerTest","Hmisc","car","lmtest","Rarity","cowplot")
ipak(packages)

# Redo long calculations
redo_calc = 0;
```

### Load Data
```{r load-data}
# Read data
AllData = read.csv("../data/AllData.csv")

# Convert to factors
AllData$Sub = as.factor(AllData$Sub)
AllData$Pred = as.factor(AllData$Pred)
AllData$Want2See = as.factor(AllData$Want2See)
AllData$Con_Rev = factor(AllData$Con, levels = c('Coop','Comp'))
```


```{r fig.width = 8, fig.height = 7}
# Plot RT
AllData_ValidTrials = filter(AllData, !(is.na(Choice)))
AllData_ValidTrials$RT_Rev = as.numeric(as.character(AllData_ValidTrials$RT))
AllData_ValidTrials$RT_Rev[AllData_ValidTrials$MotCon == FALSE] = AllData_ValidTrials$RT_Rev[AllData_ValidTrials$MotCon == FALSE] * - 1

PPC = read.csv("https://www.dropbox.com/s/vm4ik0qyx3svpm2/full_100000_ppc_data.csv?dl=1", header = F)

# Wrangle data
colnames(PPC) = c("p_rt","p_resp","index","Sub","stim","response","rt","condition","mot_con")
PPC$Sub = as.factor(PPC$Sub)
PPC$p_rt = abs(PPC$p_rt)

PPC$p_mot_con = (PPC$p_resp > 0.5) & (PPC$condition > 0.5) | (PPC$p_resp < 0.5) & (PPC$condition < 0.5)
PPC$RT_Rev = PPC$p_rt
PPC$RT_Rev[PPC$p_mot_con == FALSE] = PPC$p_rt[PPC$p_mot_con == FALSE] * - 1

# Recode subject
AllSub = NULL
AllSub$Sub = unique(AllData_ValidTrials$Sub)
AllSub$SubID = c(1:30)
AllSub = as.data.frame(AllSub)
AllSub$SubID = factor(AllSub$SubID)

AllData_ValidTrials = left_join(AllData_ValidTrials,AllSub)
PPC = left_join(PPC,AllSub)

# Plot one subject
ggplot() + 
  geom_histogram(data = AllData_ValidTrials,  aes(x = RT_Rev, y = ..ncount..)) +
  geom_line(data = PPC, stat = "density", aes(x = RT_Rev, y = ..scaled..), size = 1.5) +
  xlab("RT(s)") + ylab("Probability") +
  theme(axis.text.y  = element_blank()) +
  facet_wrap(~ SubID)
```

**Observed and predicted choice and RT distribution of each participant.** Solid black line indicates the predicted choice and RT distribution given the best-fitting parameters of that participant. RTs for motivationally inconsistent categorizations were sign-flipped for illustration purposes. Consistent with the data, the model predicts more and faster motivationally consistent categorizations (positive values) than motivationally inconsistent categorizations (negative values).
